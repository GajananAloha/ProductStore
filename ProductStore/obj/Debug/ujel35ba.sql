DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'ProductStore.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202001041429003_initialMigration'
BEGIN
    CREATE TABLE [dbo].[Categories] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](200) NOT NULL,
        CONSTRAINT [PK_dbo.Categories] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Products] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](200) NOT NULL,
        [Unit] [nvarchar](20) NOT NULL,
        [Price] [decimal](18, 2) NOT NULL,
        [Currency] [nvarchar](20) NOT NULL,
        [CategoryId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.Products] PRIMARY KEY ([Id])
    )
    CREATE INDEX [IX_CategoryId] ON [dbo].[Products]([CategoryId])
    CREATE TABLE [dbo].[Currencies] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](200) NOT NULL,
        CONSTRAINT [PK_dbo.Currencies] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Units] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](200) NOT NULL,
        CONSTRAINT [PK_dbo.Units] PRIMARY KEY ([Id])
    )
    ALTER TABLE [dbo].[Products] ADD CONSTRAINT [FK_dbo.Products_dbo.Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [dbo].[Categories] ([Id])
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202001041429003_initialMigration', N'ProductStore.Migrations.Configuration',  0x1F8B0800000000000400ED5ADD6EDB3614BE1FB077107439A456D2DE7481DD22739221589314515AEC2EA0A5638718456A2415D818F664BBD823ED1576A87F89922D3B49DDAD4180C016793E9E7F929FFCCF5F7F8FDF2F23E63C805454F0897B343A741DE08108295F4CDC44CF5FBD75DFBFFBFEBBF159182D9DCFC5BC37661E4A723571EFB58E8F3D4F05F71011358A68208512733D0A44E4915078AF0F0F7FF48E8E3C400817B11C677C93704D2348BFE0D7A9E001C43A21EC5284C054FE1C47FC14D5B92211A8980430713F4A112681F6B59030CAA6BBCE09A30455F181CD5D87702E34D1A8E8F12705BE96822FFC181F1076BB8A01E7CD0953901B705C4D1F6ACBE16B638B5709165041A2B488B6043C7A933BC76B8BEFE462B7741EBAEF0CDDAC57C6EAD48513774A342C845CB94E7BB1E329936662A7874785DC81531F3D28330213C7FC1D38D384E944C28443A22561383F99311AFC02AB5BF11BF0094F18ABAB884AE258E3013EC24562907A7503F35CF18BD075BCA69CD7162CC56A329949175CBF79ED3A57B83899312833A0667E6AD0CFC041A2A9E147A235486E3020F5A1B57A6B2DF3BF580D530ECBC7752EC9F203F085BE9FB81820D739A74B088B27B9069F38C56A43212D13E8D0B0B5EA1579A08B54E1D6FA7958B0166E80A513D43D8DB39218E5837755F4CFA5886E04AB04CBB1BB5B2217A0D116D133C117890C5AAA8DBD2AD5D626608EB66DFEE5CF5ED26FBFE9D75A15A5F5DA559F63D18F9206A5ADA710D0883017F3023FE59BD85BD7F1036200BB9CBE1E7D9A48891BE0EA8B9B5594D7E6AC19DA12AA6A7F6C4B282ABEB725143D63A79650B97CCB3D29977B690A7B6C0A83A39CF58AED226C645EA2FB1546F7442911D0D48CE6BE5EF593A6EE673C74363597CC925A73427B30B634C668A20E13F707CB256B60CB634C055BF5BA26EE91858B5900D2848130BC9B28CC2BCAB59D32940734266C830A2DB981C9669C5FAED01E398518B8C9930D4E1DB2747DE3B15528576A55C2260F8DBD5A8ED88D0165344A806CA6CFE9CC0CC0B2AB53E05D2E6F162ACFDD762E18601F74D32E0A7826AEB2D84A052BA39A28D5B9DAC228B3740344B5BFD96A94431B304C27ECD221EBAA2DE19AE72D436A1B7E6D5ADFA1A09D0E03CAB8D4BCEE3B2BAF06146E0DA81ECA764B6E1ADBD1BBCA54AB58052FA3150AFAC1EBE11FC697248EB1AFD6F888FC89E36764C4F495BFFD253DCA30BC4075DCD54B6DCB957097200B688DE2D2A8E939954A9F124D66C474EE691859D3ACC2EAC9B36239AB76ECC81529588898CF8D1CEB640E3A7A510E708EF645A697A57276D83B4453668830223BF6DFA96049C4FBDB6ABF74B6A3D6E5B32736C2D86BE96EF54DCB4DADB46D3B7E5058CA827A6C508AD6B57D4C7A25F71D923E84AC43D611BA7AE63A84FCC25987C81F0DC7A81A7D1DA6AFFDAF45AA6DD70DAC35DBF8DE12B634F0D15DA407684817E915DD77CAEE2928D959E2B11149AB68FB68748BFDAF23611D44DA53CAD5CB0349EBE031CE0F019BDF8E58A7826C8AE1C7C4030DCD89C05F290DD1C84C18F9BFB329A3686F35E192703A07A5B3CBB3B946BE6DBD5FF97ADE75784A856CE00B8F2FCE0050E3D58D77FC2D59C2FAA59F3F1019DC13695FFB9F86B1E9DCEABF65CFAD27C07B401FC76F87CFCD6F3F95D6367D9D46D1BAC55FF0109613F78F54ECD8B9F8F5AE923C70AE2576A063E7D0F9F3A992B87BF7FF96B3783BC6F6C56D1BDCF6082AB4A2627622292D0E65370E7527AE73CDADFEB9C8CDFF0E996953338398CA4E82B01CCA0E72B823CC04C6394BD335BC580F8FB98EC6EC5AA18FC2DB8DE4ECB4211B1D6243B6DBF670A05DD8396BBA077AB41DD2269F35800FED22529F87FCB4EF165810B5DF67613D2ABAA820CCAFB538048D5228E75CF0B928AAB2A55131A5D59A2F419310EBE4446A3A2781C6E100944A5F677D262CC12967D10CC20B7E9DE838D168324433D670A2A9EC75EBA70C6F53E7F1759CBE117F0A13504D8A26C035FF29A12C2CF53EEFD8457A204CCBC8F73B134B6DF6BDC5AA44BA127C2050EEBEB2D3DD4214330453D7DC270FB08B6E9F147C80050956C515B11F6473209A6E1F9F52B29024523946258F5F3187C368F9EE5F5B19B74BA6280000 , N'6.4.0')
END

